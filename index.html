<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dramari-Top</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #667eea 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        /* Header Styles */
        .header {
            position: sticky;
            top: 0;
            background: rgba(30, 60, 114, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .lang-toggle, .playlist-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .lang-toggle:hover, .playlist-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .playlist-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .playlist-btn:hover {
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        /* Search Bar */
        .search-container {
            position: relative;
        }

        .search-bar {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .search-bar::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-bar:focus {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
        }

        /* Main Content */
        .container {
            padding: 20px;
        }

        /* Category Filters */
        .category-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .category-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .category-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-color: transparent;
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .category-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Video Grid */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .video-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            background: rgba(255, 255, 255, 0.15);
        }

        .video-thumbnail {
            width: 100%;
            height: 180px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .video-card:hover .video-thumbnail {
            transform: scale(1.05);
        }

        .video-info {
            padding: 15px;
        }

        .video-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .video-description {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        /* Video Actions */
        .video-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        .rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stars {
            display: flex;
            gap: 2px;
        }

        .star {
            color: #ffd700;
            cursor: pointer;
            transition: color 0.2s ease;
            font-size: 0.9rem;
        }

        .star.empty {
            color: rgba(255, 255, 255, 0.3);
        }

        .star:hover {
            color: #ffed4a;
        }

        .rating-score {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            margin-left: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 6px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .action-btn.added {
            background: linear-gradient(45deg, #4caf50, #45a049);
        }

        /* Loading indicator for video cards */
        .video-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: none;
            z-index: 10;
        }

        .video-card.loading .video-loading {
            display: block;
        }

        /* Video Player */
        .video-player {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .video-container {
            position: relative;
            max-width: 95%;
            max-height: 95%;
        }

        .video-player video {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
        }

        /* App Icon on Video */
        .video-app-icon {
            position: absolute;
            top: 5px;
            right: 130px;
            width: 180px;
            height: 30px;
            border-radius: 12px;
            background: rgba(30, 60, 114, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            z-index: 1002;
            transition: all 0.3s ease;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .video-app-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.6);

        }
       .video-app-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
        }
        .close-player, .share-btn {
            position: absolute;
            top: 5px;
            background: transparent;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-player {
            right: 10px;
        }

        .share-btn {
            right: 70px;
            background: transparent;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
        }

        .close-player:hover, .share-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(255, 107, 107, 0.6);
        }

        .share-btn:hover {
            box-shadow: 0 6px 25px rgba(76, 175, 80, 0.6);
        }

        .close-player img, .share-btn img {
            width: 35px;
            height: 35px;
        }

        /* Playlist Modal */
        .playlist-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .playlist-content {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 15px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .playlist-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close-playlist {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .playlist-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .playlist-item img {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 5px;
            margin-right: 10px;
        }

        .playlist-item-info {
            flex: 1;
        }

        .playlist-item-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .playlist-item-desc {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .remove-from-playlist {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            border: none;
            color: white;
            padding: 5px 8px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        /* Share Modal */
        .share-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            backdrop-filter: blur(10px);
        }

        .share-content {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .share-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .share-option {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 15px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .share-option:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
       }

        .share-option img {
            width: 50px;
            height: 50px;
        }

        .copy-link {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .copy-link input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            outline: none;
        }

        .copy-btn {
            background: linear-gradient(45deg, #4caf50, #45a049);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .video-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 15px;
            }
            
            .header {
                padding: 12px 15px;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .container {
                padding: 15px;
            }

             .video-app-icon {
                width: 130px;
                height: 40px;
                top: 10px;
                right: 130px;
                font-size: 0.8rem;
            }

            .close-player {
                top: 10px;
                right: 10px;
                padding: 10px 14px;
                font-size: 1.1rem;
            }

            .share-btn {
                top: 10px;
                right: 600px;
                padding: 10px 14px;
                font-size: 1.1rem;
            }

            .header-actions {
                gap: 5px;
            }

            .lang-toggle, .playlist-btn {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .video-grid {
                grid-template-columns: 1fr;
            }
            
            .category-filters {
                gap: 8px;
            }
            
            .category-btn {
                padding: 8px 16px;
                font-size: 0.9rem;
            }

            .video-app-icon {
                width: 35px;
                height: 35px;
            }

            .close-player {
                right: 50px;
            }

            .share-btn {
                right: 90px;
            }
        }

        /* Arabic styles */
        body.arabic {
            direction: rtl;
        }

        body.arabic .header-content {
            flex-direction: row-reverse;
        }

        body.arabic .search-icon {
            left: 15px;
            right: auto;
        }

        body.arabic .search-bar {
            padding: 12px 15px 12px 45px;
        }

        body.arabic .close-player {
            left: 10px;
            right: auto;
        }

        body.arabic .share-btn {
            left: 70px;
            right: auto;
        }

        body.arabic .video-app-icon {
            left: 130px;
            right: auto;
        }

        body.arabic .playlist-item:hover {
            transform: translateX(-5px);
        }

        body.arabic .playlist-item img {
            margin-left: 10px;
            margin-right: 0;
        }

        /* Arabic responsive adjustments */
        @media (max-width: 768px) {
            body.arabic .close-player {
                left: 60px;
                right: auto;
            }

            body.arabic .share-btn {
                left: 110px;
                right: auto;
            }

            body.arabic .video-app-icon {
                left: 10px;
                right: auto;
            }
        }

        @media (max-width: 480px) {
            body.arabic .close-player {
                left: 50px;
                right: auto;
            }

            body.arabic .share-btn {
                left: 90px;
                right: auto;
            }
        }

        /* Loading Animation */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-left-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #4caf50, #45a049);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
            z-index: 4000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        body.arabic .notification {
            left: 20px;
            right: auto;
            transform: translateX(-400px);
        }

        body.arabic .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">🎬 Dramari-Top</div>
            <div class="header-actions">
                <button class="playlist-btn" onclick="openPlaylist()">
                    <span id="playlistIcon">📋 قائمة التشغيل</span>
                </button>
                <button class="lang-toggle" onclick="toggleLanguage()">
                    <span id="langIcon">🌐 AR</span>
                </button>
            </div>
        </div>
        <div class="search-container">
            <input type="text" class="search-bar" id="searchBar" placeholder="Search movies and series and cartoon..." onkeyup="searchContent()">
            <div class="search-icon">🔍</div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Category Filters -->
        <div class="category-filters">
            <button class="category-btn active" onclick="filterContent('all')" data-en="All" data-ar="الكل">All</button>
            <button class="category-btn" onclick="filterContent('movies')" data-en="Movies" data-ar="أفلام">Movies</button>
            <button class="category-btn" onclick="filterContent('series')" data-en="Series" data-ar="مسلسلات">Series</button>
            <button class="category-btn" onclick="filterContent('cartoon')" data-en="cartoon" data-ar="كرتون">cartoon</button>
        </div>

        <!-- Video Grid -->
        <div class="video-grid" id="videoGrid">
            <!-- Content will be loaded here -->
        </div>
    </div>

    <!-- Video Player -->
    <div id="videoPlayer" class="video-player">
        <div class="video-container">
 <div class="video-app-icon">
                <img src="data/icon/icon.png" alt="Dramari-Top" loading="lazy">
            </div>
            <button class="share-btn" onclick="openShareModal()" title="مشاركة">
                <img src="data/icon/share.png" alt="Share">
            </button>
            <button class="close-player" onclick="closePlayer()">
                <img src="data/icon/close.png" alt="Close">
            </button>
            <video id="mainVideo" controls>
                Your browser does not support video playback
            </video>
        </div>
    </div>

    <!-- Playlist Modal -->
    <div id="playlistModal" class="playlist-modal">
        <div class="playlist-content">
            <div class="playlist-header">
                <h2 class="playlist-title" id="playlistTitle">قائمة التشغيل</h2>
                <button class="close-playlist" onclick="closePlaylist()">×</button>
            </div>
            <div class="playlist-items" id="playlistItems">
                <!-- Playlist items will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="share-modal">
        <div class="share-content">
            <h3 id="shareTitle">مشاركة الفيديو</h3>
            <div class="share-options">
                <button class="share-option" onclick="shareToWhatsApp()" title="واتساب">
                    <img src="data/icon/whatsapp.png" alt="WhatsApp">
                </button>
                <button class="share-option" onclick="shareToFacebook()" title="فيسبوك">
                    <img src="data/icon/facebook.png" alt="Facebook">
                </button>
                <button class="share-option" onclick="shareToTwitter()" title="تويتر">
                    <img src="data/icon/twitter.png" alt="Twitter">
                </button>
                <button class="share-option" onclick="shareToTelegram()" title="تيليجرام">
                    <img src="data/icon/telegram.png" alt="Telegram">
                </button>
            </div>
            <div class="copy-link">
                <input type="text" id="shareLink" readonly>
                <button class="copy-btn" onclick="copyLink()" id="copyBtn">نسخ</button>
            </div>
            <button class="close-playlist" onclick="closeShareModal()" style="margin-top: 15px;">×</button>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Video data with Archive.org URLs - الصور من المسار المحلي والفيديوهات من Archive.org
        const videoData = {
            movies: [
                {
                     id: 1,
                    title: "مسلسل عمر",
                    titleAr: "الحلقة 1 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/movies/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/-1.mp4",
                    archiveId: "omar-series-ep1",
                    category: "movies",
                    rating: 4.8,
                    userRating: 0
                },
                {
                    id: 1,
                    title: "Example Movie 2",
                    titleAr: "فيلم مثال 2",
                    description: "Another great movie",
                    descriptionAr: "فيلم رائع آخر",
                    thumbnail: "data/movies/2.jpg",
                    videoUrl: "https://archive.org/download/example-movie-2/movie-2.mp4",
                    archiveId: "example-movie-2",
                    category: "movies",
                    rating: 4.5,
                    userRating: 0
                }
            ],
            series: [
                {
                    id: 2,
                    title: "الحلقة 1 من مسلسل عمر",
                    titleAr: "الحلقة 1 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/series/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/omar1_202508/omar1.mp4",
                    archiveId: "omar-series-ep1",
                    category: "series",
                    rating: 4.8,
                    userRating: 0
                },
                {
                    id: 2,
                    title: "الحلقة 2 من مسلسل عمر",
                    titleAr: "الحلقة 2 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/series/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/omar1_202508/omar2.mp4",
                    archiveId: "omar-series-ep1",
                    category: "series",
                    rating: 4.8,
                    userRating: 0
                                    },
                {
                    id: 2,
                    title: "الحلقة 3 من مسلسل عمر",
                    titleAr: "الحلقة 3 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/series/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/omar1_202508/omar3.mp4",
                    archiveId: "omar-series-ep1",
                    category: "series",
                    rating: 4.8,
                    userRating: 0
                                    },
                {
                    id: 2,
                    title: "الحلقة 4 من مسلسل عمر",
                    titleAr: "الحلقة 4 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/series/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/omar1_202508/omar4.mp4",
                    archiveId: "omar-series-ep1",
                    category: "series",
                    rating: 4.8,
                    userRating: 0
                                    },
                {
                    id: 2,
                    title: "الحلقة 5 من مسلسل عمر",
                    titleAr: "الحلقة 5 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/series/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/omar1_202508/omar5.mp4",
                    archiveId: "omar-series-ep1",
                    category: "series",
                    rating: 4.8,
                    userRating: 0
                                    },
                {
                    id: 2,
                    title: "الحلقة 6 من مسلسل عمر",
                    titleAr: "الحلقة 6 من مسلسل عمر",
                    description: "احسن مسلسل تاريخي",
                    descriptionAr: "مسلسل سيرة ذاتية درامي تاريخي -كتابة وليد سيف، وإخراج حاتم علي",
                    thumbnail: "data/series/omar.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/omar1_202508/omar6.mp4",
                    archiveId: "omar-series-ep1",
                    category: "series",
                    rating: 4.8,
                    userRating: 0
                }
            ],
            cartoon: [
                {
                    id: 3,
                    title: "Paw Patrol: The Movie (2021) 2",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021) | First Scene",
                    descriptionAr: "دورية المخلب: الفيلم (2021)",
                    thumbnail: "data/cartoon/paw.jpg",
                    videoUrl: "https://archive.org/download/paw1_20250803_202508/paw1.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.1,
                    userRating: 0
                },
                {
     
                    id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw1_20250803_202508/paw2.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                    id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021) | First Scene",
                    descriptionAr: "دورية المخلب: الفيلم (2021)",
                    thumbnail: "data/cartoon/paw.jpg", // الصورة من المسار المحلي
                    videoUrl: "https://archive.org/download/paw1_20250803_202508/paw3.mp4", // رابط Archive.org
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
               
                   id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw4.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
               id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw5.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw6.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw7.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw8.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw9.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {

                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw10.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw11.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw12.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw13.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw14.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw15.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw16.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw17.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw18.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw19.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw20.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0
                },
                {
                 id: 3,
                    title: "Paw Patrol: The Movie (2021)",
                    titleAr: "دورية المخلب: الفيلم (2021)",
                    description: "Paw Patrol: The Movie (2021)",
                    descriptionAr: "دورية المخلب: الفيلم (2021) | المشهد الأول",
                    thumbnail: "data/cartoon/paw.jpg", 
                    videoUrl: "https://archive.org/download/paw9_20250803/paw21.mp4.mp4",
                    archiveId: "paw-patrol-movie",
                    category: "cartoon",
                    rating: 4.3,
                    userRating: 0

                }
            ]
        };

        // App state
        let currentLanguage = 'en';
        let currentFilter = 'all';
        let allVideos = [...videoData.movies, ...videoData.series, ...videoData.cartoon];
        let playlist = [];
        let currentVideo = null;

        // Language translations
        const translations = {
            en: {
                searchPlaceholder: "Search movies and series and cartoon...",
                all: "All",
                movies: "Movies",
                series: "Series",
                cartoon: "cartoon",
                videoNotSupported: "Your browser does not support video playback",
                playlistTitle: "Playlist",
                shareTitle: "Share Video",
                addToPlaylist: "Add to Playlist",
                removeFromPlaylist: "Remove",
                addedToPlaylist: "Added to playlist!",
                removedFromPlaylist: "Removed from playlist!",
                linkCopied: "Link copied!",
                copyBtn: "Copy",
                closeBtn: "Close",
                rateVideo: "Rate this video",
                playlistBtn: "📋 Playlist",
                loading: "Loading video...",
                videoError: "Error loading video from Archive.org",
                videoUnavailable: "Video temporarily unavailable"
            },
            ar: {
                searchPlaceholder: "البحث في الأفلام والمسلسلات و الكرتون...",
                all: "الكل",
                movies: "أفلام",
                series: "مسلسلات",
                cartoon: "كرتون",
                videoNotSupported: "متصفحك لا يدعم تشغيل الفيديو",
                playlistTitle: "قائمة التشغيل",
                shareTitle: "مشاركة الفيديو",
                addToPlaylist: "أضف للقائمة",
                removeFromPlaylist: "إزالة",
                addedToPlaylist: "تم الإضافة لقائمة التشغيل!",
                removedFromPlaylist: "تم الحذف من قائمة التشغيل!",
                linkCopied: "تم نسخ الرابط!",
                copyBtn: "نسخ",
                closeBtn: "إغلاق",
                rateVideo: "قيم هذا الفيديو",
                playlistBtn: "📋 قائمة التشغيل",
                loading: "جاري تحميل الفيديو...",
                videoError: "خطأ في تحميل الفيديو من Archive.org",
                videoUnavailable: "الفيديو غير متاح مؤقتاً"
            
                
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            displayVideos(allVideos);
            updateLanguage();
            loadPlaylistFromStorage();
        });

        // Toggle language
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
            updateLanguage();
        }

        // Update language
        function updateLanguage() {
            const body = document.body;
            const langIcon = document.getElementById('langIcon');
            const searchBar = document.getElementById('searchBar');
            const mainVideo = document.getElementById('mainVideo');
            const playlistIcon = document.getElementById('playlistIcon');
            const playlistTitle = document.getElementById('playlistTitle');
            const shareTitle = document.getElementById('shareTitle');
            const copyBtn = document.getElementById('copyBtn');
            
            if (currentLanguage === 'ar') {
                body.classList.add('arabic');
                body.setAttribute('dir', 'rtl');
                langIcon.textContent = '🌐 EN';
                searchBar.placeholder = translations.ar.searchPlaceholder;
                mainVideo.textContent = translations.ar.videoNotSupported;
                playlistIcon.textContent = translations.ar.playlistBtn;
                playlistTitle.textContent = translations.ar.playlistTitle;
                shareTitle.textContent = translations.ar.shareTitle;
                copyBtn.textContent = translations.ar.copyBtn;
            } else {
                body.classList.remove('arabic');
                body.setAttribute('dir', 'ltr');
                langIcon.textContent = '🌐 AR';
                searchBar.placeholder = translations.en.searchPlaceholder;
                mainVideo.textContent = translations.en.videoNotSupported;
                playlistIcon.textContent = translations.en.playlistBtn;
                playlistTitle.textContent = translations.en.playlistTitle;
                shareTitle.textContent = translations.en.shareTitle;
                copyBtn.textContent = translations.en.copyBtn;
            }

            // Update category buttons
            const categoryBtns = document.querySelectorAll('.category-btn');
            categoryBtns.forEach(btn => {
                const key = btn.getAttribute('onclick').match(/'(\w+)'/)[1];
                if (translations[currentLanguage][key]) {
                    btn.textContent = translations[currentLanguage][key];
                }
            });

            // Refresh video display
            displayVideos(getFilteredVideos());
        }

        // Filter content
        function filterContent(category) {
            currentFilter = category;
            
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Display filtered videos
            const filteredVideos = getFilteredVideos();
            displayVideos(filteredVideos);
        }

        // Get filtered videos
        function getFilteredVideos() {
            if (currentFilter === 'all') {
                return allVideos;
            }
            return allVideos.filter(video => video.category === currentFilter);
        }

        // Search content
        function searchContent() {
            const searchTerm = document.getElementById('searchBar').value.toLowerCase();
            const filteredVideos = getFilteredVideos();
            
            if (searchTerm === '') {
                displayVideos(filteredVideos);
                return;
            }
            
            const searchResults = filteredVideos.filter(video => {
                const title = currentLanguage === 'ar' ? video.titleAr : video.title;
                const description = currentLanguage === 'ar' ? video.descriptionAr : video.description;
                return title.toLowerCase().includes(searchTerm) || 
                       description.toLowerCase().includes(searchTerm);
            });
            
            displayVideos(searchResults);
        }

        // Display videos
        function displayVideos(videos) {
            const videoGrid = document.getElementById('videoGrid');
            
            if (videos.length === 0) {
                const noResultsText = currentLanguage === 'ar' ? 
                    'لا توجد نتائج للبحث' : 'No results found';
                videoGrid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: rgba(255,255,255,0.7);">
                        <div style="font-size: 3rem; margin-bottom: 20px;">🔍</div>
                        <p style="font-size: 1.2rem;">${noResultsText}</p>
                    </div>
                `;
                return;
            }
            
            videoGrid.innerHTML = videos.map(video => {
                const title = currentLanguage === 'ar' ? video.titleAr : video.title;
                const description = currentLanguage === 'ar' ? video.descriptionAr : video.description;
                const isInPlaylist = playlist.some(item => item.id === video.id);
                const addToPlaylistText = currentLanguage === 'ar' ? 
                    translations.ar.addToPlaylist : translations.en.addToPlaylist;
                
                return `
                    <div class="video-card" id="card-${video.id}">
                        <div class="video-loading">${translations[currentLanguage].loading}</div>
                        <img src="${video.thumbnail}" alt="${title}" class="video-thumbnail" loading="lazy" onclick="playVideo('${video.videoUrl}', ${video.id})">
                        <div class="video-info">
                            <div class="video-title">${title}</div>
                            <div class="video-description">${description}</div>
                            <div class="video-actions">
                                <div class="rating">
                                    <div class="stars" data-video-id="${video.id}">
                                        ${generateStars(video.userRating || 0, video.id)}
                                    </div>
                                    <span class="rating-score">(${video.rating.toFixed(1)})</span>
                                </div>
                                <div class="action-buttons">
                                    <button class="action-btn ${isInPlaylist ? 'added' : ''}" onclick="togglePlaylist(${video.id})" title="${addToPlaylistText}">
                                        ${isInPlaylist ? '✓' : '📋'}
                                    </button>
                                    <button class="action-btn" onclick="shareVideo(${video.id})" title="مشاركة">📤</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Generate star rating
        function generateStars(rating, videoId) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                stars += `<span class="star ${i <= rating ? '' : 'empty'}" onclick="rateVideo(${videoId}, ${i})">★</span>`;
            }
            return stars;
        }

        // Rate video
        function rateVideo(videoId, rating) {
            const video = allVideos.find(v => v.id === videoId);
            if (video) {
                video.userRating = rating;
                // Update display
                displayVideos(getFilteredVideos());
                showNotification(currentLanguage === 'ar' ? 
                    `تم تقييم الفيديو بـ ${rating} نجوم!` : 
                    `Video rated ${rating} stars!`);
            }
        }

        // Toggle playlist
        function togglePlaylist(videoId) {
            const video = allVideos.find(v => v.id === videoId);
            const existingIndex = playlist.findIndex(item => item.id === videoId);
            
            if (existingIndex > -1) {
                playlist.splice(existingIndex, 1);
                showNotification(translations[currentLanguage].removedFromPlaylist);
            } else {
                playlist.push(video);
                showNotification(translations[currentLanguage].addedToPlaylist);
            }
            
            savePlaylistToStorage();
            displayVideos(getFilteredVideos());
        }

        // Play video with Archive.org integration
        function playVideo(videoUrl, videoId = null) {
            if (!videoUrl || videoUrl === '#') {
                const message = currentLanguage === 'ar' ? 
                    translations.ar.videoUnavailable : 
                    translations.en.videoUnavailable;
                showNotification(message);
                return;
            }
            
            // Find video data
            currentVideo = allVideos.find(v => v.id === videoId);
            
            // Show loading state
            if (videoId) {
                const card = document.getElementById(`card-${videoId}`);
                if (card) card.classList.add('loading');
            }
            
            const player = document.getElementById('videoPlayer');
            const video = document.getElementById('mainVideo');
            
            // Set up video source
            video.src = videoUrl;
            player.style.display = 'flex';
            
            // Handle video loading
            video.addEventListener('loadstart', function() {
                console.log('Started loading video from Archive.org');
            });
            
            video.addEventListener('canplay', function() {
                console.log('Video can start playing');
                if (videoId) {
                    const card = document.getElementById(`card-${videoId}`);
                    if (card) card.classList.remove('loading');
                }
            });
            
            video.addEventListener('error', function(e) {
                console.error('Video error:', e);
                const message = currentLanguage === 'ar' ? 
                    translations.ar.videoError : 
                    translations.en.videoError;
                showNotification(message);
                
                if (videoId) {
                    const card = document.getElementById(`card-${videoId}`);
                    if (card) card.classList.remove('loading');
                }
                
                // Try alternative URL format for Archive.org
                if (currentVideo && currentVideo.archiveId) {
                    const alternativeUrl = `https://archive.org/serve/${currentVideo.archiveId}`;
                    console.log('Trying alternative URL:', alternativeUrl);
                    video.src = alternativeUrl;
                }
            });
            
            // Start playing
            video.play().catch(e => {
                console.error('Video play failed:', e);
                const message = currentLanguage === 'ar' ? 
                    translations.ar.videoError : 
                    translations.en.videoError;
                showNotification(message);
                
                if (videoId) {
                    const card = document.getElementById(`card-${videoId}`);
                    if (card) card.classList.remove('loading');
                }
            });
        }

        // Close video player
        function closePlayer() {
            const player = document.getElementById('videoPlayer');
            const video = document.getElementById('mainVideo');
            
            video.pause();
            video.src = '';
            player.style.display = 'none';
            currentVideo = null;
            
            // Remove loading states
            document.querySelectorAll('.video-card.loading').forEach(card => {
                card.classList.remove('loading');
            });
        }

        // Open playlist
        function openPlaylist() {
            const modal = document.getElementById('playlistModal');
            const playlistItems = document.getElementById('playlistItems');
            
            if (playlist.length === 0) {
                const emptyText = currentLanguage === 'ar' ? 
                    'قائمة التشغيل فارغة' : 'Playlist is empty';
                playlistItems.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: rgba(255,255,255,0.7);">
                        <div style="font-size: 3rem; margin-bottom: 20px;">📋</div>
                        <p>${emptyText}</p>
                    </div>
                `;
            } else {
                playlistItems.innerHTML = playlist.map(video => {
                    const title = currentLanguage === 'ar' ? video.titleAr : video.title;
                    const description = currentLanguage === 'ar' ? video.descriptionAr : video.description;
                    const removeText = translations[currentLanguage].removeFromPlaylist;
                    
                    return `
                        <div class="playlist-item">
                            <img src="${video.thumbnail}" alt="${title}" onclick="playVideo('${video.videoUrl}', ${video.id}); closePlaylist();">
                            <div class="playlist-item-info">
                                <div class="playlist-item-title">${title}</div>
                                <div class="playlist-item-desc">${description}</div>
                            </div>
                            <button class="remove-from-playlist" onclick="togglePlaylist(${video.id}); openPlaylist();" title="${removeText}">×</button>
                        </div>
                    `;
                }).join('');
            }
            
            modal.style.display = 'flex';
        }

        // Close playlist
        function closePlaylist() {
            document.getElementById('playlistModal').style.display = 'none';
        }

        // Share video
        function shareVideo(videoId) {
            currentVideo = allVideos.find(v => v.id === videoId);
            openShareModal();
        }

        // Open share modal
        function openShareModal() {
            if (!currentVideo) return;
            
            const modal = document.getElementById('shareModal');
            const shareLink = document.getElementById('shareLink');
            
            // Generate share link with Archive.org URL
            const link = currentVideo.videoUrl || `${window.location.origin}${window.location.pathname}?video=${currentVideo.id}`;
            shareLink.value = link;
            
            modal.style.display = 'flex';
        }

        // Close share modal
        function closeShareModal() {
            document.getElementById('shareModal').style.display = 'none';
        }

        // Share to WhatsApp
        function shareToWhatsApp() {
            if (!currentVideo) return;
            const title = currentLanguage === 'ar' ? currentVideo.titleAr : currentVideo.title;
            const text = encodeURIComponent(`${title} - Watch on Archive.org: ${currentVideo.videoUrl}`);
            window.open(`https://wa.me/?text=${text}`, '_blank');
        }

        // Share to Facebook
        function shareToFacebook() {
            if (!currentVideo) return;
            const url = encodeURIComponent(currentVideo.videoUrl);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
        }

        // Share to Twitter
        function shareToTwitter() {
            if (!currentVideo) return;
            const title = currentLanguage === 'ar' ? currentVideo.titleAr : currentVideo.title;
            const text = encodeURIComponent(`${title} - Watch on Archive.org`);
            const url = encodeURIComponent(currentVideo.videoUrl);
            window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
        }

        // Share to Telegram
        function shareToTelegram() {
            if (!currentVideo) return;
            const title = currentLanguage === 'ar' ? currentVideo.titleAr : currentVideo.title;
            const text = encodeURIComponent(`${title} - ${currentVideo.videoUrl}`);
            window.open(`https://t.me/share/url?url=${text}`, '_blank');
        }

        // Copy link
        function copyLink() {
            const shareLink = document.getElementById('shareLink');
            shareLink.select();
            shareLink.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showNotification(translations[currentLanguage].linkCopied);
            } catch (err) {
                console.error('Failed to copy link:', err);
                // Fallback for modern browsers
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(shareLink.value).then(() => {
                        showNotification(translations[currentLanguage].linkCopied);
                    }).catch(err => {
                        console.error('Clipboard API failed:', err);
                    });
                }
            }
        }

        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Save playlist to memory (localStorage replacement)
        function savePlaylistToStorage() {
            try {
                // In a real environment with localStorage support:
                // localStorage.setItem('dramari-playlist', JSON.stringify(playlist));
                console.log('Playlist saved to memory:', playlist);
            } catch (e) {
                console.log('Could not save playlist');
            }
        }

        // Load playlist from memory (localStorage replacement)
        function loadPlaylistFromStorage() {
            try {
                // In a real environment with localStorage support:
                // const saved = localStorage.getItem('dramari-playlist');
                // if (saved) playlist = JSON.parse(saved);
                playlist = [];
                console.log('Playlist loaded from memory');
            } catch (e) {
                console.log('Could not load playlist');
                playlist = [];
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePlayer();
                closePlaylist();
                closeShareModal();
            }
            
            // Space bar to play/pause video
            if (e.key === ' ' && document.getElementById('videoPlayer').style.display === 'flex') {
                e.preventDefault();
                const video = document.getElementById('mainVideo');
                if (video.paused) {
                    video.play();
                } else {
                    video.pause();
                }
            }
        });

        // Close modals when clicking outside
        document.getElementById('videoPlayer').addEventListener('click', function(e) {
            if (e.target === this) closePlayer();
        });

        document.getElementById('playlistModal').addEventListener('click', function(e) {
            if (e.target === this) closePlaylist();
        });

        document.getElementById('shareModal').addEventListener('click', function(e) {
            if (e.target === this) closeShareModal();
        });

        // Handle orientation change
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                const videos = getFilteredVideos();
                const searchTerm = document.getElementById('searchBar').value.toLowerCase();
                
                if (searchTerm !== '') {
                    searchContent();
                } else {
                    displayVideos(videos);
                }
            }, 100);
        });

        // Smooth scroll for better mobile experience
        document.addEventListener('touchstart', function() {}, {passive: true});

        // Auto-play next video in playlist (optional feature)
        document.getElementById('mainVideo').addEventListener('ended', function() {
            if (playlist.length > 0 && currentVideo) {
                const currentIndex = playlist.findIndex(v => v.id === currentVideo.id);
                if (currentIndex !== -1 && currentIndex < playlist.length - 1) {
                    const nextVideo = playlist[currentIndex + 1];
                    setTimeout(() => {
                        playVideo(nextVideo.videoUrl, nextVideo.id);
                    }, 1000); // Small delay before playing next video
                }
            }
        });

        // Network status monitoring
        window.addEventListener('online', function() {
            showNotification(currentLanguage === 'ar' ? 
                'تم الاتصال بالإنترنت' : 
                'Internet connection restored');
        });

        window.addEventListener('offline', function() {
            showNotification(currentLanguage === 'ar' ? 
                'انقطع الاتصال بالإنترنت' : 
                'Internet connection lost');
        });

        // Archive.org specific functions
        function getArchiveStreamUrl(archiveId, filename) {
            return `https://archive.org/download/${archiveId}/${filename}`;
        }

        function getArchiveDetailsUrl(archiveId) {
            return `https://archive.org/details/${archiveId}`;
        }

        // Pre-load video metadata for better performance
        function preloadVideoMetadata() {
            allVideos.forEach(video => {
                if (video.videoUrl && video.videoUrl.includes('archive.org')) {
                    const tempVideo = document.createElement('video');
                    tempVideo.preload = 'metadata';
                    tempVideo.src = video.videoUrl;
                    tempVideo.addEventListener('loadedmetadata', function() {
                        console.log(`Metadata loaded for: ${video.title}`);
                    });
                    tempVideo.addEventListener('error', function() {
                        console.warn(`Failed to load metadata for: ${video.title}`);
                    });
                }
            });
        }

        // Initialize preloading after page load
        window.addEventListener('load', function() {
            setTimeout(preloadVideoMetadata, 2000);
        });
    </script>
</body>
</html>
